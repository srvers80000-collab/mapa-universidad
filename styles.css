:root{
    --bg: #f2f2f2;
    --panel:#111;
    --accent:#4ab3ff;
    --btn:#007bff;
    --text:#111;
    --map-tilt-perspective: 700px;
}
body{
    margin:0;
    font-family:Inter,Arial,Helvetica,sans-serif;
    background:var(--bg);
    color:var(--text);
}
/* INTRO OVERLAY */
.intro-overlay{
    position:fixed; inset:0; background:linear-gradient(180deg, rgba(3,3,10,0.95), rgba(5,10,30,0.95));
    display:flex; align-items:center; justify-content:center; z-index:9999; animation: fadeIn 0.6s ease both;
}
.intro-card{
    text-align:center; background: rgba(255,255,255,0.03); padding:28px; border-radius:12px; border:1px solid rgba(255,255,255,0.06);
    color:#fff; width:min(680px, 92%); box-shadow: 0 12px 40px rgba(0,0,0,0.6); transform: translateY(10px); animation: popIn 0.6s cubic-bezier(.2,.9,.2,1);
}
.intro-card h1{ font-size:34px; margin:0 0 6px;}
.intro-card h2{ font-size:18px; margin:0 0 8px; color: #9ad8ff;}
.intro-card .subtitle{ color: #d7eefe; margin-bottom:14px; opacity:0.9;}
.intro-actions{ display:flex; gap:12px; justify-content:center; margin-top:12px;}
.intro-actions button{ padding:10px 16px; border-radius:8px; border:0; cursor:pointer; font-weight:600;}
.intro-actions button#startIntro{ background: #20c997; color: #042; }
.intro-actions button#skipIntro{ background: transparent; color:#fff; border:1px solid rgba(255,255,255,0.12);}
@keyframes popIn { from { transform: translateY(20px) scale(.98); opacity:0; } to { transform: translateY(0) scale(1); opacity:1; } }
@keyframes fadeIn { from { opacity:0 } to { opacity:1 } }

/* MENU LATERAL */
#menu{
    position:fixed; left:0; top:0; width:320px; height:100vh; padding:18px; box-sizing:border-box; background:linear-gradient(180deg,var(--panel),#0b0b0b);
    color:white; box-shadow:3px 0 8px rgba(0,0,0,0.35); z-index:999; overflow:auto;
}
#menu h2{ margin:0 0 10px; color:var(--accent); }
.control{ margin-bottom:14px; }
.control label{ font-size:13px; color:#ddd; display:block; margin-bottom:6px;}
.control input[type="text"]{ width:100%; padding:10px; border-radius:6px; border:0; box-sizing:border-box; font-size:14px;}
.btn-grid{ display:grid; grid-template-columns:1fr 1fr; gap:8px; }
button{ background:var(--btn); color:white; border:0; padding:10px; border-radius:6px; cursor:pointer; font-size:14px;}
button:disabled{ opacity:0.5; cursor:not-allowed; }
.row{ display:flex; gap:8px; }
select{ width:100%; padding:8px; border-radius:6px; border:0; box-sizing:border-box; margin-bottom:8px;}
.suggestions{ position:relative; max-height:140px; overflow:auto; background:rgba(255,255,255,0.95); color:#111; border-radius:6px; margin-top:6px; display:none; box-shadow:0 6px 18px rgba(0,0,0,0.15);}
.suggestions .item{ padding:8px 10px; cursor:pointer; border-bottom:1px solid #eee;}
.suggestions .item:hover{ background:#f4f4f4; }
.hint{ display:block; color:#cfd8dd; font-size:12px; margin-top:8px; }

/* MAPA */
#map{ position:fixed; left:320px; right:0; top:0; bottom:0; z-index:1; transform-origin: center; transition: transform 600ms cubic-bezier(.2,.9,.2,1), filter 400ms; will-change: transform; }
#map.tilted{ transform: perspective(var(--map-tilt-perspective)) rotateX(22deg) translateY(-30px) scale(1.02); filter: drop-shadow(0 18px 24px rgba(0,0,0,0.45)) saturate(1.05); }
.leaflet-container .leaflet-popup { transform-origin: center bottom; }

/* MARCADORES 3D */
.extrusion { position: relative; display:inline-block; transform-style: preserve-3d; pointer-events:none; }
.extrusion .base { width:18px; height:18px; border-radius:50%; background:#1e90ff; box-shadow: 0 6px 12px rgba(30,144,255,0.22); position:relative; z-index:2; transform: translateZ(20px); }
.extrusion .column { position:absolute; left:50%; transform:translateX(-50%); bottom:100%; width:6px; height:40px; background: linear-gradient(180deg, rgba(30,144,255,0.95), rgba(15,76,145,0.9)); border-radius:3px; opacity:0.95; z-index:1; filter: blur(0.6px); }
.extrusion.h1 .column{ height:26px; } .extrusion.h2 .column{ height:40px; } .extrusion.h3 .column{ height:62px; }

/* DEBUG PANEL */
.debug-panel{ position: fixed; right: 18px; bottom: 18px; width: 260px; padding: 12px; background: rgba(12,12,14,0.92); color: #e5eef8; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.45); z-index: 9998; font-size: 13px; display:none; }
.debug-panel h4{ margin:0 0 8px; color:var(--accent); }
.debug-panel button{ margin-top:8px; background:#ff6b6b; }

/* TEMA OSCURO */
body.dark{ --bg:#0b0b0d; --panel:#0b0b0b; --btn:#2b7be9; --text:#eee; }
body.dark #menu{ background: linear-gradient(180deg,#0b0b0b,#070707); }

/* RESPONSIVE */
@media (max-width:900px){ #menu{ width: 280px; } #map{ left:280px; } }

/* PANEL DE INSTRUCCIONES LATERAL */
#panel-instrucciones{ position: fixed; top: 0; right: -350px; width: 350px; height: 100%; background: #ffffffee; box-shadow: 0 0 18px rgba(0,0,0,0.35); padding: 20px; transition: right 0.4s ease; overflow-y: auto; backdrop-filter: blur(4px); z-index: 9999; }
#panel-instrucciones h2{ margin-top: 0; color: #1e90ff; }
#panel-instrucciones ul{ padding-left: 20px; }
#panel-instrucciones button.cerrar-panel{ margin-top: 14px; padding: 10px; width: 100%; background: #ff4444; color: #fff; border: none; border-radius: 6px; cursor: pointer; }